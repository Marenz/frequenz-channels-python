
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Frequenz's channels implementation for Python.">
      
      
        <meta name="author" content="Frequenz Energy-as-a-Service GmbH">
      
      
      <link rel="icon" href="../../../logo.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>channels - Frequenz's channels for Python</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/style.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frequenz.channels" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest (stable) version.
  <a href="../../../.."> 
    <strong>Click here to go to latest (stable) version</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Frequenz&#39;s channels for Python" class="md-header__button md-logo" aria-label="Frequenz's channels for Python" data-md-component="logo">
      
  <img src="../../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Frequenz's channels for Python
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              channels
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/frequenz-floss/frequenz-channels-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    frequenz-channels-python
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../CONTRIBUTING/" class="md-tabs__link">
      Development
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Frequenz&#39;s channels for Python" class="md-nav__button md-logo" aria-label="Frequenz's channels for Python" data-md-component="logo">
      
  <img src="../../../logo.png" alt="logo">

    </a>
    Frequenz's channels for Python
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/frequenz-floss/frequenz-channels-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    frequenz-channels-python
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          frequenz
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="frequenz" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          frequenz
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1_1" type="checkbox" id="__nav_2_1_1" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">channels</a>
          
            <label for="__nav_2_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="channels" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_1_1">
          <span class="md-nav__icon md-icon"></span>
          channels
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="anycast/" class="md-nav__link">
        anycast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="base_classes/" class="md-nav__link">
        base_classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="bidirectional/" class="md-nav__link">
        bidirectional
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="broadcast/" class="md-nav__link">
        broadcast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="merge/" class="md-nav__link">
        merge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="merge_named/" class="md-nav__link">
        merge_named
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="select/" class="md-nav__link">
        select
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1_1_8" type="checkbox" id="__nav_2_1_1_8" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="utils/">utils</a>
          
            <label for="__nav_2_1_1_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="utils" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_1_1_8">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/file_watcher/" class="md-nav__link">
        file_watcher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/timer/" class="md-nav__link">
        timer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Development
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#frequenz.channels" class="md-nav__link">
    channels
  </a>
  
    <nav class="md-nav" aria-label="channels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Anycast" class="md-nav__link">
    Anycast
  </a>
  
    <nav class="md-nav" aria-label="Anycast">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Anycast-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.anycast.Anycast.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.anycast.Anycast.close" class="md-nav__link">
    close()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.anycast.Anycast.get_receiver" class="md-nav__link">
    get_receiver()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.anycast.Anycast.get_sender" class="md-nav__link">
    get_sender()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Bidirectional" class="md-nav__link">
    Bidirectional
  </a>
  
    <nav class="md-nav" aria-label="Bidirectional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Bidirectional-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.bidirectional.Bidirectional.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.bidirectional.Bidirectional.client_handle" class="md-nav__link">
    client_handle()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.bidirectional.Bidirectional.service_handle" class="md-nav__link">
    service_handle()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.BidirectionalHandle" class="md-nav__link">
    BidirectionalHandle
  </a>
  
    <nav class="md-nav" aria-label="BidirectionalHandle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.BidirectionalHandle-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.bidirectional.BidirectionalHandle.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.bidirectional.BidirectionalHandle.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.bidirectional.BidirectionalHandle.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.bidirectional.BidirectionalHandle.send" class="md-nav__link">
    send()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Broadcast" class="md-nav__link">
    Broadcast
  </a>
  
    <nav class="md-nav" aria-label="Broadcast">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Broadcast-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.broadcast.Broadcast.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.broadcast.Broadcast.close" class="md-nav__link">
    close()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.broadcast.Broadcast.get_peekable" class="md-nav__link">
    get_peekable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.broadcast.Broadcast.get_receiver" class="md-nav__link">
    get_receiver()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.broadcast.Broadcast.get_sender" class="md-nav__link">
    get_sender()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.BufferedReceiver" class="md-nav__link">
    BufferedReceiver
  </a>
  
    <nav class="md-nav" aria-label="BufferedReceiver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.BufferedReceiver-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.BufferedReceiver.enqueue" class="md-nav__link">
    enqueue()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.FileWatcher" class="md-nav__link">
    FileWatcher
  </a>
  
    <nav class="md-nav" aria-label="FileWatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.FileWatcher-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.file_watcher.FileWatcher.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.file_watcher.FileWatcher.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.file_watcher.FileWatcher.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.file_watcher.FileWatcher.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Merge" class="md-nav__link">
    Merge
  </a>
  
    <nav class="md-nav" aria-label="Merge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Merge-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge.Merge.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge.Merge.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge.Merge.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge.Merge.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.MergeNamed" class="md-nav__link">
    MergeNamed
  </a>
  
    <nav class="md-nav" aria-label="MergeNamed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.MergeNamed-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge_named.MergeNamed.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge_named.MergeNamed.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge_named.MergeNamed.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.merge_named.MergeNamed.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Peekable" class="md-nav__link">
    Peekable
  </a>
  
    <nav class="md-nav" aria-label="Peekable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Peekable-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Peekable.peek" class="md-nav__link">
    peek()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Receiver" class="md-nav__link">
    Receiver
  </a>
  
    <nav class="md-nav" aria-label="Receiver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Receiver-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Receiver.__aiter__" class="md-nav__link">
    __aiter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Receiver.__anext__" class="md-nav__link">
    __anext__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Receiver.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Receiver.into_peekable" class="md-nav__link">
    into_peekable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Receiver.map" class="md-nav__link">
    map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Receiver.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Receiver.receive" class="md-nav__link">
    receive()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Select" class="md-nav__link">
    Select
  </a>
  
    <nav class="md-nav" aria-label="Select">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Select-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.select.Select.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.select.Select.__getattr__" class="md-nav__link">
    __getattr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.select.Select.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.select.Select.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Sender" class="md-nav__link">
    Sender
  </a>
  
    <nav class="md-nav" aria-label="Sender">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Sender-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.base_classes.Sender.send" class="md-nav__link">
    send()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Timer" class="md-nav__link">
    Timer
  </a>
  
    <nav class="md-nav" aria-label="Timer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.Timer-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.timer.Timer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.timer.Timer.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.timer.Timer.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.timer.Timer.reset" class="md-nav__link">
    reset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.utils.timer.Timer.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/frequenz-floss/frequenz-channels-python/edit/v0.x.x/src/frequenz/channels/__init__.py" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
  </a>


  <h1>channels</h1>

<div class="doc doc-object doc-module">



<h2 id="frequenz.channels" class="doc doc-heading">
          <code>frequenz.channels</code>


<a href="#frequenz.channels" class="headerlink" title="Permanent link">¤</a></h2>

  <div class="doc doc-contents first">
  
      <p>Channel implementations.</p>

  

  <div class="doc doc-children">






<h3 id="frequenz.channels-classes">Classes<a href="#frequenz.channels-classes" class="headerlink" title="Permanent link">¤</a></h3>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Anycast" class="doc doc-heading">
        <code>frequenz.channels.Anycast</code>


<a href="#frequenz.channels.Anycast" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code></p>

  
      <p>A channel for sending data across async tasks.</p>
<p>Anycast channels support multiple senders and multiple receivers.  A message sent
through a sender will be received by exactly one receiver.</p>
<p>In cases where each message need to be received by every receiver, a
<a class="autorefs autorefs-internal" href="#frequenz.channels.Broadcast">Broadcast</a> channel may be used.</p>
<p>Uses an <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/collections.html#collections.deque">deque</a> internally, so Anycast channels are not
thread-safe.</p>
<p>When there are multiple channel receivers, they can be awaited
simultaneously using <a class="autorefs autorefs-internal" href="#frequenz.channels.Select">Select</a>,
<a class="autorefs autorefs-internal" href="#frequenz.channels.Merge">Merge</a> or
<a class="autorefs autorefs-internal" href="#frequenz.channels.MergeNamed">MergeNamed</a>.</p>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="n">sender</span><span class="p">:</span> <span class="n">channel</span><span class="o">.</span><span class="n">Sender</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sending: </span><span class="si">{</span><span class="nb">next</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">next</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">receiver</span><span class="p">:</span> <span class="n">channel</span><span class="o">.</span><span class="n">Receiver</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receiver</span><span class="o">.</span><span class="n">receive</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;receiver_</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> received </span><span class="si">{</span><span class="nb">next</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># sleep (or work) with the data</span>


<span class="n">acast</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">Anycast</span><span class="p">()</span>

<span class="n">sender</span> <span class="o">=</span> <span class="n">acast</span><span class="o">.</span><span class="n">get_sender</span><span class="p">()</span>
<span class="n">receiver_1</span> <span class="o">=</span> <span class="n">acast</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">()</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">send</span><span class="p">(</span><span class="n">sender</span><span class="p">))</span>

<span class="k">await</span> <span class="n">recv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">receiver_1</span><span class="p">)</span>
</code></pre></div>
<p>Check the <code>tests</code> and <code>benchmarks</code> directories for more examples.</p>
</details>

        <details class="quote">
          <summary>Source code in <code>frequenz/channels/anycast.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Anycast</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A channel for sending data across async tasks.</span>

<span class="sd">    Anycast channels support multiple senders and multiple receivers.  A message sent</span>
<span class="sd">    through a sender will be received by exactly one receiver.</span>

<span class="sd">    In cases where each message need to be received by every receiver, a</span>
<span class="sd">    [Broadcast][frequenz.channels.Broadcast] channel may be used.</span>

<span class="sd">    Uses an [deque][collections.deque] internally, so Anycast channels are not</span>
<span class="sd">    thread-safe.</span>

<span class="sd">    When there are multiple channel receivers, they can be awaited</span>
<span class="sd">    simultaneously using [Select][frequenz.channels.Select],</span>
<span class="sd">    [Merge][frequenz.channels.Merge] or</span>
<span class="sd">    [MergeNamed][frequenz.channels.MergeNamed].</span>

<span class="sd">    Example:</span>
<span class="sd">        ``` python</span>
<span class="sd">        async def send(sender: channel.Sender) -&gt; None:</span>
<span class="sd">            while True:</span>
<span class="sd">                next = random.randint(3, 17)</span>
<span class="sd">                print(f&quot;sending: {next}&quot;)</span>
<span class="sd">                await sender.send(next)</span>


<span class="sd">        async def recv(id: int, receiver: channel.Receiver) -&gt; None:</span>
<span class="sd">            while True:</span>
<span class="sd">                next = await receiver.receive()</span>
<span class="sd">                print(f&quot;receiver_{id} received {next}&quot;)</span>
<span class="sd">                await asyncio.sleep(0.1) # sleep (or work) with the data</span>


<span class="sd">        acast = channel.Anycast()</span>

<span class="sd">        sender = acast.get_sender()</span>
<span class="sd">        receiver_1 = acast.get_receiver()</span>

<span class="sd">        asyncio.create_task(send(sender))</span>

<span class="sd">        await recv(1, receiver_1)</span>
<span class="sd">        ```</span>

<span class="sd">        Check the `tests` and `benchmarks` directories for more examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create an Anycast channel.</span>

<span class="sd">        Args:</span>
<span class="sd">            maxsize: Size of the channel&#39;s buffer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">maxsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deque</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">maxsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cv</span><span class="p">:</span> <span class="n">Condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span> <span class="n">Condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the channel.</span>

<span class="sd">        Any further attempts to [send()][frequenz.channels.Sender.send] data</span>
<span class="sd">        will return `False`.</span>

<span class="sd">        Receivers will still be able to drain the pending items on the channel,</span>
<span class="sd">        but after that, subsequent</span>
<span class="sd">        [receive()][frequenz.channels.Receiver.receive] calls will return `None`</span>
<span class="sd">        immediately.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cv</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cv</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sender</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a new sender.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Sender instance attached to the Anycast channel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a new receiver.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Receiver instance attached to the Anycast channel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Anycast-functions">Functions<a href="#frequenz.channels.Anycast-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.anycast.Anycast.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#frequenz.channels.anycast.Anycast.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create an Anycast channel.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>maxsize</code></td>
          <td class="doc-param-details">
            <p>Size of the channel's buffer.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>10</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/anycast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create an Anycast channel.</span>

<span class="sd">    Args:</span>
<span class="sd">        maxsize: Size of the channel&#39;s buffer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">maxsize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deque</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">maxsize</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">send_cv</span><span class="p">:</span> <span class="n">Condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span> <span class="n">Condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.anycast.Anycast.close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.anycast.Anycast.close" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Close the channel.</p>
<p>Any further attempts to <a class="autorefs autorefs-internal" href="base_classes/#frequenz.channels.base_classes.Sender.send">send()</a> data
will return <code>False</code>.</p>
<p>Receivers will still be able to drain the pending items on the channel,
but after that, subsequent
<a class="autorefs autorefs-internal" href="base_classes/#frequenz.channels.base_classes.Receiver.receive">receive()</a> calls will return <code>None</code>
immediately.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/anycast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Close the channel.</span>

<span class="sd">    Any further attempts to [send()][frequenz.channels.Sender.send] data</span>
<span class="sd">    will return `False`.</span>

<span class="sd">    Receivers will still be able to drain the pending items on the channel,</span>
<span class="sd">    but after that, subsequent</span>
<span class="sd">    [receive()][frequenz.channels.Receiver.receive] calls will return `None`</span>
<span class="sd">    immediately.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cv</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cv</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>
    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.anycast.Anycast.get_receiver" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_receiver</span><span class="p">()</span></code>

<a href="#frequenz.channels.anycast.Anycast.get_receiver" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new receiver.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A Receiver instance attached to the Anycast channel.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/anycast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Create a new receiver.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Receiver instance attached to the Anycast channel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.anycast.Anycast.get_sender" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_sender</span><span class="p">()</span></code>

<a href="#frequenz.channels.anycast.Anycast.get_sender" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new sender.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Sender" href="base_classes/#frequenz.channels.base_classes.Sender">Sender</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A Sender instance attached to the Anycast channel.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/anycast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sender</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Create a new sender.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Sender instance attached to the Anycast channel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Bidirectional" class="doc doc-heading">
        <code>frequenz.channels.Bidirectional</code>


<a href="#frequenz.channels.Bidirectional" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.base_classes.T">T</span>, <span title="frequenz.channels.base_classes.U">U</span>]</code></p>

  
      <p>A wrapper class for simulating bidirectional channels.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Bidirectional</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">U</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A wrapper class for simulating bidirectional channels.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a `Bidirectional` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            client_id: A name for the client, used to name the channels.</span>
<span class="sd">            service_id: A name for the service end of the channels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_id</span> <span class="o">=</span> <span class="n">client_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_request_channel</span><span class="p">:</span> <span class="n">Broadcast</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;req_</span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_channel</span><span class="p">:</span> <span class="n">Broadcast</span><span class="p">[</span><span class="n">U</span><span class="p">]</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;resp_</span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client_handle</span> <span class="o">=</span> <span class="n">BidirectionalHandle</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_request_channel</span><span class="o">.</span><span class="n">get_sender</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_channel</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_service_handle</span> <span class="o">=</span> <span class="n">BidirectionalHandle</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_channel</span><span class="o">.</span><span class="n">get_sender</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_request_channel</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">client_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BidirectionalHandle</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">U</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a BidirectionalHandle for the client to use.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Object to send/receive messages with.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_handle</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">service_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BidirectionalHandle</span><span class="p">[</span><span class="n">U</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a `BidirectionalHandle` for the service to use.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Object to send/receive messages with.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_handle</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Bidirectional-functions">Functions<a href="#frequenz.channels.Bidirectional-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.bidirectional.Bidirectional.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">service_id</span><span class="p">)</span></code>

<a href="#frequenz.channels.bidirectional.Bidirectional.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>Bidirectional</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>client_id</code></td>
          <td class="doc-param-details">
            <p>A name for the client, used to name the channels.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>service_id</code></td>
          <td class="doc-param-details">
            <p>A name for the service end of the channels.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a `Bidirectional` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        client_id: A name for the client, used to name the channels.</span>
<span class="sd">        service_id: A name for the service end of the channels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_client_id</span> <span class="o">=</span> <span class="n">client_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_request_channel</span><span class="p">:</span> <span class="n">Broadcast</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;req_</span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_response_channel</span><span class="p">:</span> <span class="n">Broadcast</span><span class="p">[</span><span class="n">U</span><span class="p">]</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;resp_</span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_client_handle</span> <span class="o">=</span> <span class="n">BidirectionalHandle</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_request_channel</span><span class="o">.</span><span class="n">get_sender</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_channel</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_service_handle</span> <span class="o">=</span> <span class="n">BidirectionalHandle</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_channel</span><span class="o">.</span><span class="n">get_sender</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_request_channel</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">(),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.bidirectional.Bidirectional.client_handle" class="doc doc-heading">
<code class="highlight language-python"><span class="n">client_handle</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.bidirectional.Bidirectional.client_handle" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Get a BidirectionalHandle for the client to use.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.bidirectional.BidirectionalHandle" href="bidirectional/#frequenz.channels.bidirectional.BidirectionalHandle">BidirectionalHandle</a>[<span title="frequenz.channels.base_classes.T">T</span>, <span title="frequenz.channels.base_classes.U">U</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Object to send/receive messages with.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">client_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BidirectionalHandle</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">U</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get a BidirectionalHandle for the client to use.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Object to send/receive messages with.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_handle</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.bidirectional.Bidirectional.service_handle" class="doc doc-heading">
<code class="highlight language-python"><span class="n">service_handle</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.bidirectional.Bidirectional.service_handle" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Get a <code>BidirectionalHandle</code> for the service to use.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.bidirectional.BidirectionalHandle" href="bidirectional/#frequenz.channels.bidirectional.BidirectionalHandle">BidirectionalHandle</a>[<span title="frequenz.channels.base_classes.U">U</span>, <span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Object to send/receive messages with.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">service_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BidirectionalHandle</span><span class="p">[</span><span class="n">U</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get a `BidirectionalHandle` for the service to use.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Object to send/receive messages with.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_handle</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.BidirectionalHandle" class="doc doc-heading">
        <code>frequenz.channels.BidirectionalHandle</code>


<a href="#frequenz.channels.BidirectionalHandle" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Sender" href="base_classes/#frequenz.channels.base_classes.Sender">Sender</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>, <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.U">U</span>]</code></p>

  
      <p>A handle to a <a class="autorefs autorefs-internal" href="#frequenz.channels.Bidirectional">Bidirectional</a> instance.</p>
<p>It can be used to send/receive values between the client and service.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BidirectionalHandle</span><span class="p">(</span><span class="n">Sender</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">U</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A handle to a [Bidirectional][frequenz.channels.Bidirectional] instance.</span>

<span class="sd">    It can be used to send/receive values between the client and service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a `BidirectionalHandle` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            sender: A sender to send values with.</span>
<span class="sd">            receiver: A receiver to receive values from.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sender</span> <span class="o">=</span> <span class="n">sender</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span> <span class="o">=</span> <span class="n">receiver</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Send a value to the other side.</span>

<span class="sd">        Args:</span>
<span class="sd">            msg: The value to send.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the send was successful or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value.&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span><span class="o">.</span><span class="n">ready</span><span class="p">()</span>  <span class="c1"># pylint: disable=protected-access</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">U</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest value once `_ready` is complete.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next value that was received.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>  <span class="c1"># pylint: disable=protected-access</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.BidirectionalHandle-functions">Functions<a href="#frequenz.channels.BidirectionalHandle-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.bidirectional.BidirectionalHandle.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">)</span></code>

<a href="#frequenz.channels.bidirectional.BidirectionalHandle.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>BidirectionalHandle</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sender</code></td>
          <td class="doc-param-details">
            <p>A sender to send values with.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Sender" href="base_classes/#frequenz.channels.base_classes.Sender">Sender</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>receiver</code></td>
          <td class="doc-param-details">
            <p>A receiver to receive values from.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.U">U</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a `BidirectionalHandle` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        sender: A sender to send values with.</span>
<span class="sd">        receiver: A receiver to receive values from.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sender</span> <span class="o">=</span> <span class="n">sender</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span> <span class="o">=</span> <span class="n">receiver</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.bidirectional.BidirectionalHandle.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.bidirectional.BidirectionalHandle.consume" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value once <code>_ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="frequenz.channels.base_classes.U">U</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The next value that was received.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">U</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest value once `_ready` is complete.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next value that was received.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>  <span class="c1"># pylint: disable=protected-access</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.bidirectional.BidirectionalHandle.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.bidirectional.BidirectionalHandle.ready" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until the receiver is ready with a value.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value.&quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span><span class="o">.</span><span class="n">ready</span><span class="p">()</span>  <span class="c1"># pylint: disable=protected-access</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.bidirectional.BidirectionalHandle.send" class="doc doc-heading">
<code class="highlight language-python"><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.bidirectional.BidirectionalHandle.send" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Send a value to the other side.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td class="doc-param-details">
            <p>The value to send.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="frequenz.channels.base_classes.T">T</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Whether the send was successful or not.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/bidirectional.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Send a value to the other side.</span>

<span class="sd">    Args:</span>
<span class="sd">        msg: The value to send.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the send was successful or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Broadcast" class="doc doc-heading">
        <code>frequenz.channels.Broadcast</code>


<a href="#frequenz.channels.Broadcast" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code></p>

  
      <p>A channel to broadcast messages to multiple receivers.</p>
<p><code>Broadcast</code> channels can have multiple senders and multiple receivers. Each
message sent through any of the senders is received by all of the
receivers.</p>
<p>Internally, a broadcast receiver's buffer is implemented with just
append/pop operations on either side of a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/collections.html#collections.deque">deque</a>, which
are thread-safe.  Because of this, <code>Broadcast</code> channels are thread-safe.</p>
<p>When there are multiple channel receivers, they can be awaited
simultaneously using <a class="autorefs autorefs-internal" href="#frequenz.channels.Select">Select</a>,
<a class="autorefs autorefs-internal" href="#frequenz.channels.Merge">Merge</a> or
<a class="autorefs autorefs-internal" href="#frequenz.channels.MergeNamed">MergeNamed</a>.</p>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="n">sender</span><span class="p">:</span> <span class="n">channel</span><span class="o">.</span><span class="n">Sender</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sending: </span><span class="si">{</span><span class="nb">next</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">next</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">receiver</span><span class="p">:</span> <span class="n">channel</span><span class="o">.</span><span class="n">Receiver</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receiver</span><span class="o">.</span><span class="n">receive</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;receiver_</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> received </span><span class="si">{</span><span class="nb">next</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># sleep (or work) with the data</span>


<span class="n">bcast</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">Broadcast</span><span class="p">()</span>

<span class="n">sender</span> <span class="o">=</span> <span class="n">bcast</span><span class="o">.</span><span class="n">get_sender</span><span class="p">()</span>
<span class="n">receiver_1</span> <span class="o">=</span> <span class="n">bcast</span><span class="o">.</span><span class="n">get_receiver</span><span class="p">()</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">send</span><span class="p">(</span><span class="n">sender</span><span class="p">))</span>

<span class="k">await</span> <span class="n">recv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">receiver_1</span><span class="p">)</span>
</code></pre></div>
<p>Check the <code>tests</code> and <code>benchmarks</code> directories for more examples.</p>
</details>

        <details class="quote">
          <summary>Source code in <code>frequenz/channels/broadcast.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Broadcast</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A channel to broadcast messages to multiple receivers.</span>

<span class="sd">    `Broadcast` channels can have multiple senders and multiple receivers. Each</span>
<span class="sd">    message sent through any of the senders is received by all of the</span>
<span class="sd">    receivers.</span>

<span class="sd">    Internally, a broadcast receiver&#39;s buffer is implemented with just</span>
<span class="sd">    append/pop operations on either side of a [deque][collections.deque], which</span>
<span class="sd">    are thread-safe.  Because of this, `Broadcast` channels are thread-safe.</span>

<span class="sd">    When there are multiple channel receivers, they can be awaited</span>
<span class="sd">    simultaneously using [Select][frequenz.channels.Select],</span>
<span class="sd">    [Merge][frequenz.channels.Merge] or</span>
<span class="sd">    [MergeNamed][frequenz.channels.MergeNamed].</span>

<span class="sd">    Example:</span>
<span class="sd">        ``` python</span>
<span class="sd">        async def send(sender: channel.Sender) -&gt; None:</span>
<span class="sd">            while True:</span>
<span class="sd">                next = random.randint(3, 17)</span>
<span class="sd">                print(f&quot;sending: {next}&quot;)</span>
<span class="sd">                await sender.send(next)</span>


<span class="sd">        async def recv(id: int, receiver: channel.Receiver) -&gt; None:</span>
<span class="sd">            while True:</span>
<span class="sd">                next = await receiver.receive()</span>
<span class="sd">                print(f&quot;receiver_{id} received {next}&quot;)</span>
<span class="sd">                await asyncio.sleep(0.1) # sleep (or work) with the data</span>


<span class="sd">        bcast = channel.Broadcast()</span>

<span class="sd">        sender = bcast.get_sender()</span>
<span class="sd">        receiver_1 = bcast.get_receiver()</span>

<span class="sd">        asyncio.create_task(send(sender))</span>

<span class="sd">        await recv(1, receiver_1)</span>
<span class="sd">        ```</span>

<span class="sd">        Check the `tests` and `benchmarks` directories for more examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">resend_latest</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a Broadcast channel.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: A name for the broadcast channel, typically based on the type</span>
<span class="sd">                of data sent through it.  Used to identify the channel in the</span>
<span class="sd">                logs.</span>
<span class="sd">            resend_latest: When True, every time a new receiver is created with</span>
<span class="sd">                `get_receiver`, it will automatically get sent the latest value</span>
<span class="sd">                on the channel.  This allows new receivers on slow streams to</span>
<span class="sd">                get the latest value as soon as they are created, without having</span>
<span class="sd">                to wait for the next message on the channel to arrive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resend_latest</span> <span class="o">=</span> <span class="n">resend_latest</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span> <span class="n">Condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">receivers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">UUID</span><span class="p">,</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ReferenceType</span><span class="p">[</span><span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_latest</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the Broadcast channel.</span>

<span class="sd">        Any further attempts to [send()][frequenz.channels.Sender.send] data</span>
<span class="sd">        will return `False`.</span>

<span class="sd">        Receivers will still be able to drain the pending items on their queues,</span>
<span class="sd">        but after that, subsequent</span>
<span class="sd">        [receive()][frequenz.channels.Receiver.receive] calls will return `None`</span>
<span class="sd">        immediately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_latest</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sender</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a new broadcast sender.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Sender instance attached to the broadcast channel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_receiver</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a new broadcast receiver.</span>

<span class="sd">        Broadcast receivers have their own buffer, and when messages are not</span>
<span class="sd">        being consumed fast enough and the buffer fills up, old messages will</span>
<span class="sd">        get dropped just in this receiver.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: A name to identify the receiver in the logs.</span>
<span class="sd">            maxsize: Size of the receiver&#39;s buffer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Receiver instance attached to the broadcast channel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uuid</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
        <span class="n">recv</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">Receiver</span><span class="p">(</span><span class="n">uuid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">receivers</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">recv</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resend_latest</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">recv</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_latest</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">recv</span>

    <span class="k">def</span> <span class="nf">get_peekable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Peekable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a new Peekable for the broadcast channel.</span>

<span class="sd">        A Peekable provides a [peek()][frequenz.channels.Peekable.peek] method</span>
<span class="sd">        that allows the user to get a peek at the latest value in the channel,</span>
<span class="sd">        without consuming anything.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Peekable to peek into the broadcast channel with.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Peekable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Broadcast-functions">Functions<a href="#frequenz.channels.Broadcast-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.broadcast.Broadcast.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">resend_latest</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#frequenz.channels.broadcast.Broadcast.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a Broadcast channel.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <p>A name for the broadcast channel, typically based on the type
of data sent through it.  Used to identify the channel in the
logs.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>resend_latest</code></td>
          <td class="doc-param-details">
            <p>When True, every time a new receiver is created with
<code>get_receiver</code>, it will automatically get sent the latest value
on the channel.  This allows new receivers on slow streams to
get the latest value as soon as they are created, without having
to wait for the next message on the channel to arrive.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/broadcast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">resend_latest</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a Broadcast channel.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: A name for the broadcast channel, typically based on the type</span>
<span class="sd">            of data sent through it.  Used to identify the channel in the</span>
<span class="sd">            logs.</span>
<span class="sd">        resend_latest: When True, every time a new receiver is created with</span>
<span class="sd">            `get_receiver`, it will automatically get sent the latest value</span>
<span class="sd">            on the channel.  This allows new receivers on slow streams to</span>
<span class="sd">            get the latest value as soon as they are created, without having</span>
<span class="sd">            to wait for the next message on the channel to arrive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_resend_latest</span> <span class="o">=</span> <span class="n">resend_latest</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span> <span class="n">Condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">receivers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">UUID</span><span class="p">,</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ReferenceType</span><span class="p">[</span><span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_latest</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.broadcast.Broadcast.close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.broadcast.Broadcast.close" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Close the Broadcast channel.</p>
<p>Any further attempts to <a class="autorefs autorefs-internal" href="base_classes/#frequenz.channels.base_classes.Sender.send">send()</a> data
will return <code>False</code>.</p>
<p>Receivers will still be able to drain the pending items on their queues,
but after that, subsequent
<a class="autorefs autorefs-internal" href="base_classes/#frequenz.channels.base_classes.Receiver.receive">receive()</a> calls will return <code>None</code>
immediately.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/broadcast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Close the Broadcast channel.</span>

<span class="sd">    Any further attempts to [send()][frequenz.channels.Sender.send] data</span>
<span class="sd">    will return `False`.</span>

<span class="sd">    Receivers will still be able to drain the pending items on their queues,</span>
<span class="sd">    but after that, subsequent</span>
<span class="sd">    [receive()][frequenz.channels.Receiver.receive] calls will return `None`</span>
<span class="sd">    immediately.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_latest</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recv_cv</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.broadcast.Broadcast.get_peekable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_peekable</span><span class="p">()</span></code>

<a href="#frequenz.channels.broadcast.Broadcast.get_peekable" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new Peekable for the broadcast channel.</p>
<p>A Peekable provides a <a class="autorefs autorefs-internal" href="base_classes/#frequenz.channels.base_classes.Peekable.peek">peek()</a> method
that allows the user to get a peek at the latest value in the channel,
without consuming anything.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Peekable" href="base_classes/#frequenz.channels.base_classes.Peekable">Peekable</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A Peekable to peek into the broadcast channel with.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/broadcast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_peekable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Peekable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Create a new Peekable for the broadcast channel.</span>

<span class="sd">    A Peekable provides a [peek()][frequenz.channels.Peekable.peek] method</span>
<span class="sd">    that allows the user to get a peek at the latest value in the channel,</span>
<span class="sd">    without consuming anything.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Peekable to peek into the broadcast channel with.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Peekable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.broadcast.Broadcast.get_receiver" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_receiver</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxsize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span></code>

<a href="#frequenz.channels.broadcast.Broadcast.get_receiver" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new broadcast receiver.</p>
<p>Broadcast receivers have their own buffer, and when messages are not
being consumed fast enough and the buffer fills up, old messages will
get dropped just in this receiver.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <p>A name to identify the receiver in the logs.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>maxsize</code></td>
          <td class="doc-param-details">
            <p>Size of the receiver's buffer.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>50</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A Receiver instance attached to the broadcast channel.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/broadcast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_receiver</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Create a new broadcast receiver.</span>

<span class="sd">    Broadcast receivers have their own buffer, and when messages are not</span>
<span class="sd">    being consumed fast enough and the buffer fills up, old messages will</span>
<span class="sd">    get dropped just in this receiver.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: A name to identify the receiver in the logs.</span>
<span class="sd">        maxsize: Size of the receiver&#39;s buffer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Receiver instance attached to the broadcast channel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">uuid</span> <span class="o">=</span> <span class="n">uuid4</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
    <span class="n">recv</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">Receiver</span><span class="p">(</span><span class="n">uuid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">receivers</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">recv</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resend_latest</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">recv</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_latest</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">recv</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.broadcast.Broadcast.get_sender" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_sender</span><span class="p">()</span></code>

<a href="#frequenz.channels.broadcast.Broadcast.get_sender" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new broadcast sender.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Sender" href="base_classes/#frequenz.channels.base_classes.Sender">Sender</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A Sender instance attached to the broadcast channel.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/broadcast.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sender</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Create a new broadcast sender.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Sender instance attached to the broadcast channel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.BufferedReceiver" class="doc doc-heading">
        <code>frequenz.channels.BufferedReceiver</code>


<a href="#frequenz.channels.BufferedReceiver" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code></p>

  
      <p>A channel receiver with a buffer.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BufferedReceiver</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A channel receiver with a buffer.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">enqueue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Put a message into this buffered receiver&#39;s queue.</span>

<span class="sd">        Args:</span>
<span class="sd">            msg: The message to be added to the queue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.BufferedReceiver-functions">Functions<a href="#frequenz.channels.BufferedReceiver-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.BufferedReceiver.enqueue" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enqueue</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#frequenz.channels.base_classes.BufferedReceiver.enqueue" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Put a message into this buffered receiver's queue.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td class="doc-param-details">
            <p>The message to be added to the queue.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="frequenz.channels.base_classes.T">T</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">enqueue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Put a message into this buffered receiver&#39;s queue.</span>

<span class="sd">    Args:</span>
<span class="sd">        msg: The message to be added to the queue.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.FileWatcher" class="doc doc-heading">
        <code>frequenz.channels.FileWatcher</code>


<a href="#frequenz.channels.FileWatcher" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib">pathlib</a>.<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code></p>

  
      <p>A channel receiver that watches for file events.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/utils/file_watcher.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileWatcher</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A channel receiver that watches for file events.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
        <span class="n">event_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">EventType</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a `FileWatcher` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            paths: Paths to watch for changes.</span>
<span class="sd">            event_types: Types of events to watch for or `None` to watch for</span>
<span class="sd">                all event types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">event_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">EventType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span> <span class="n">EventType</span><span class="o">.</span><span class="n">MODIFY</span><span class="p">,</span> <span class="n">EventType</span><span class="o">.</span><span class="n">DELETE</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">event_types</span> <span class="o">=</span> <span class="n">event_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">path</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="k">else</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span> <span class="o">=</span> <span class="n">awatch</span><span class="p">(</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_paths</span><span class="p">,</span>
            <span class="n">stop_event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="p">,</span>
            <span class="n">watch_filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">change</span><span class="p">,</span> <span class="n">path_str</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">change</span> <span class="ow">in</span> <span class="p">[</span><span class="n">event_type</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">event_type</span> <span class="ow">in</span> <span class="n">event_types</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
                <span class="ow">and</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">FileChange</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cleanup registered watches.</span>

<span class="sd">        `awatch` passes the `stop_event` to a separate task/thread. This way</span>
<span class="sd">        `awatch` getting destroyed properly. The background task will continue</span>
<span class="sd">        until the signal is received.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Wait for the next file event and return its path.</span>

<span class="sd">        Raises:</span>
<span class="sd">            StopAsyncIteration: When the channel is closed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path of next file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest change once `ready` is complete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ChannelClosedError: When the channel is closed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next change that was received.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>
        <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="c1"># Tuple of (Change, path) returned by watchfiles</span>
        <span class="k">if</span> <span class="n">change</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">change</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">path_str</span> <span class="o">=</span> <span class="n">change</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.FileWatcher-functions">Functions<a href="#frequenz.channels.FileWatcher-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.file_watcher.FileWatcher.__del__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

<a href="#frequenz.channels.utils.file_watcher.FileWatcher.__del__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Cleanup registered watches.</p>
<p><code>awatch</code> passes the <code>stop_event</code> to a separate task/thread. This way
<code>awatch</code> getting destroyed properly. The background task will continue
until the signal is received.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Cleanup registered watches.</span>

<span class="sd">    `awatch` passes the `stop_event` to a separate task/thread. This way</span>
<span class="sd">    `awatch` getting destroyed properly. The background task will continue</span>
<span class="sd">    until the signal is received.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.file_watcher.FileWatcher.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">event_types</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#frequenz.channels.utils.file_watcher.FileWatcher.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>FileWatcher</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>paths</code></td>
          <td class="doc-param-details">
            <p>Paths to watch for changes.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib">pathlib</a>.<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>event_types</code></td>
          <td class="doc-param-details">
            <p>Types of events to watch for or <code>None</code> to watch for
all event types.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Set" href="https://docs.python.org/3/library/typing.html#typing.Set">Set</a>[<a class="autorefs autorefs-internal" title="frequenz.channels.utils.file_watcher.EventType" href="utils/file_watcher/#frequenz.channels.utils.file_watcher.EventType">EventType</a>]]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">event_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">EventType</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a `FileWatcher` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        paths: Paths to watch for changes.</span>
<span class="sd">        event_types: Types of events to watch for or `None` to watch for</span>
<span class="sd">            all event types.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">event_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">event_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">EventType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span> <span class="n">EventType</span><span class="o">.</span><span class="n">MODIFY</span><span class="p">,</span> <span class="n">EventType</span><span class="o">.</span><span class="n">DELETE</span><span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">event_types</span> <span class="o">=</span> <span class="n">event_types</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">path</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="k">else</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span> <span class="o">=</span> <span class="n">awatch</span><span class="p">(</span>
        <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_paths</span><span class="p">,</span>
        <span class="n">stop_event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="p">,</span>
        <span class="n">watch_filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">change</span><span class="p">,</span> <span class="n">path_str</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">change</span> <span class="ow">in</span> <span class="p">[</span><span class="n">event_type</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">event_type</span> <span class="ow">in</span> <span class="n">event_types</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
            <span class="ow">and</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">FileChange</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.file_watcher.FileWatcher.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.utils.file_watcher.FileWatcher.consume" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest change once <code>ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.ChannelClosedError" href="base_classes/#frequenz.channels.base_classes.ChannelClosedError">ChannelClosedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>When the channel is closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib">pathlib</a>.<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The next change that was received.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest change once `ready` is complete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ChannelClosedError: When the channel is closed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next change that was received.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>
    <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="c1"># Tuple of (Change, path) returned by watchfiles</span>
    <span class="k">if</span> <span class="n">change</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">change</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">path_str</span> <span class="o">=</span> <span class="n">change</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.file_watcher.FileWatcher.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.utils.file_watcher.FileWatcher.ready" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait for the next file event and return its path.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#StopAsyncIteration">StopAsyncIteration</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>When the channel is closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>None</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Path of next file.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wait for the next file event and return its path.</span>

<span class="sd">    Raises:</span>
<span class="sd">        StopAsyncIteration: When the channel is closed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path of next file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Merge" class="doc doc-heading">
        <code>frequenz.channels.Merge</code>


<a href="#frequenz.channels.Merge" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code></p>

  
      <p>Merge messages coming from multiple channels into a single stream.</p>

<details class="example">
  <summary>Example</summary>
  <p>For example, if there are two channel receivers with the same type,
they can be awaited together, and their results merged into a single
stream, by using <code>Merge</code> like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">merge</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="n">receiver1</span><span class="p">,</span> <span class="n">receiver2</span><span class="p">)</span>
<span class="k">while</span> <span class="n">msg</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">merge</span><span class="o">.</span><span class="n">receive</span><span class="p">():</span>
    <span class="c1"># do something with msg</span>
    <span class="k">pass</span>
</code></pre></div>
</details>

        <details class="quote">
          <summary>Source code in <code>frequenz/channels/merge.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Merge</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Merge messages coming from multiple channels into a single stream.</span>

<span class="sd">    Example:</span>
<span class="sd">        For example, if there are two channel receivers with the same type,</span>
<span class="sd">        they can be awaited together, and their results merged into a single</span>
<span class="sd">        stream, by using `Merge` like this:</span>

<span class="sd">        ```python</span>
<span class="sd">        merge = Merge(receiver1, receiver2)</span>
<span class="sd">        while msg := await merge.receive():</span>
<span class="sd">            # do something with msg</span>
<span class="sd">            pass</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a `Merge` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: sequence of channel receivers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span> <span class="n">recv</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ChannelClosedError: if the underlying channel is closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
        <span class="c1"># previous `wait` completed because a channel was closed.</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
            <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
                <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                    <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            EOFError: When called before a call to `ready()` finishes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next value that was received.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Merge-functions">Functions<a href="#frequenz.channels.Merge-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge.Merge.__del__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

<a href="#frequenz.channels.merge.Merge.__del__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Cleanup any pending tasks.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge.Merge.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

<a href="#frequenz.channels.merge.Merge.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>Merge</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>*args</code></td>
          <td class="doc-param-details">
            <p>sequence of channel receivers.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>()</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a `Merge` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        *args: sequence of channel receivers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span> <span class="n">recv</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">)}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge.Merge.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.merge.Merge.consume" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value once <code>ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#EOFError">EOFError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>When called before a call to <code>ready()</code> finishes.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="frequenz.channels.base_classes.T">T</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The next value that was received.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        EOFError: When called before a call to `ready()` finishes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next value that was received.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge.Merge.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.merge.Merge.ready" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until the receiver is ready with a value.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.ChannelClosedError" href="base_classes/#frequenz.channels.base_classes.ChannelClosedError">ChannelClosedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>if the underlying channel is closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ChannelClosedError: if the underlying channel is closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
    <span class="c1"># previous `wait` completed because a channel was closed.</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
        <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
            <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.MergeNamed" class="doc doc-heading">
        <code>frequenz.channels.MergeNamed</code>


<a href="#frequenz.channels.MergeNamed" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="frequenz.channels.base_classes.T">T</span>]]</code></p>

  
      <p>Merge messages coming from multiple named channels into a single stream.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/merge_named.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MergeNamed</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]]):</span>
    <span class="sd">&quot;&quot;&quot;Merge messages coming from multiple named channels into a single stream.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a `MergeNamed` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: sequence of channel receivers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Wait until there&#39;s a message in any of the channels.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ChannelClosedError: when all the channels are closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
        <span class="c1"># previous `wait` completed because a channel was closed.</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
            <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
                <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                    <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            EOFError: When called before a call to `ready()` finishes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next value that was received, along with its name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.MergeNamed-functions">Functions<a href="#frequenz.channels.MergeNamed-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge_named.MergeNamed.__del__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

<a href="#frequenz.channels.merge_named.MergeNamed.__del__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Cleanup any pending tasks.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge_named.MergeNamed.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#frequenz.channels.merge_named.MergeNamed.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>MergeNamed</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <p>sequence of channel receivers.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a `MergeNamed` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: sequence of channel receivers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge_named.MergeNamed.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.merge_named.MergeNamed.consume" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value once <code>ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#EOFError">EOFError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>When called before a call to <code>ready()</code> finishes.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The next value that was received, along with its name.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        EOFError: When called before a call to `ready()` finishes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next value that was received, along with its name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.merge_named.MergeNamed.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.merge_named.MergeNamed.ready" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until there's a message in any of the channels.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.ChannelClosedError" href="base_classes/#frequenz.channels.base_classes.ChannelClosedError">ChannelClosedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>when all the channels are closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wait until there&#39;s a message in any of the channels.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ChannelClosedError: when all the channels are closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
    <span class="c1"># previous `wait` completed because a channel was closed.</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
        <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
            <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Peekable" class="doc doc-heading">
        <code>frequenz.channels.Peekable</code>


<a href="#frequenz.channels.Peekable" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code>, <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code></p>

  
      <p>A channel peekable.</p>
<p>A Peekable provides a <a class="autorefs autorefs-internal" href="#frequenz.channels.Peekable">peek()</a> method that
allows the user to get a peek at the latest value in the channel, without
consuming anything.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Peekable</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A channel peekable.</span>

<span class="sd">    A Peekable provides a [peek()][frequenz.channels.Peekable] method that</span>
<span class="sd">    allows the user to get a peek at the latest value in the channel, without</span>
<span class="sd">    consuming anything.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest value that was sent to the channel.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The latest value received by the channel, and `None`, if nothing</span>
<span class="sd">                has been sent to the channel yet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Peekable-functions">Functions<a href="#frequenz.channels.Peekable-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Peekable.peek" class="doc doc-heading">
<code class="highlight language-python"><span class="n">peek</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#frequenz.channels.base_classes.Peekable.peek" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value that was sent to the channel.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The latest value received by the channel, and <code>None</code>, if nothing
has been sent to the channel yet.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest value that was sent to the channel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The latest value received by the channel, and `None`, if nothing</span>
<span class="sd">            has been sent to the channel yet.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Receiver" class="doc doc-heading">
        <code>frequenz.channels.Receiver</code>


<a href="#frequenz.channels.Receiver" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code>, <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code></p>

  
      <p>A channel Receiver.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Receiver</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A channel Receiver.&quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__anext__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Await the next value in the async iteration over received values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next value received.</span>

<span class="sd">        Raises:</span>
<span class="sd">            StopAsyncIteration: if the underlying channel is closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">ready</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">ChannelClosedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StopAsyncIteration</span><span class="p">()</span> <span class="kn">from</span> <span class="nn">exc</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value.</span>

<span class="sd">        Once a call to `ready()` has finished, the value should be read with a call to</span>
<span class="sd">        `consume()`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ChannelClosedError: if the underlying channel is closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest value once `ready()` is complete.</span>

<span class="sd">        `ready()` must be called before each call to `consume()`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next value received.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ChannelClosedError: if the underlying channel is closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__aiter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Initialize the async iterator over received values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            `self`, since no extra setup is needed for the iterator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Receive a message from the channel.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ChannelClosedError: if the underlying channel is closed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The received message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">received</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">()</span>  <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
        <span class="k">except</span> <span class="ne">StopAsyncIteration</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span> <span class="kn">from</span> <span class="nn">exc</span>
        <span class="k">return</span> <span class="n">received</span>

    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">U</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a receiver with `call` applied on incoming messages.</span>

<span class="sd">        Args:</span>
<span class="sd">            call: function to apply on incoming messages.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A `Receiver` to read results of the given function from.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_Map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">into_peekable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Peekable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Convert the `Receiver` implementation into a `Peekable`.</span>

<span class="sd">        Once this function has been called, the receiver will no longer be</span>
<span class="sd">        usable, and calling `receive` on the receiver will raise an exception.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: when a `Receiver` implementation doesn&#39;t have</span>
<span class="sd">                a custom `get_peekable` implementation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This receiver does not implement `into_peekable`&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Receiver-functions">Functions<a href="#frequenz.channels.Receiver-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Receiver.__aiter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__aiter__</span><span class="p">()</span></code>

<a href="#frequenz.channels.base_classes.Receiver.__aiter__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Initialize the async iterator over received values.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p><code>self</code>, since no extra setup is needed for the iterator.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__aiter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Initialize the async iterator over received values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        `self`, since no extra setup is needed for the iterator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Receiver.__anext__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__anext__</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.base_classes.Receiver.__anext__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Await the next value in the async iteration over received values.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="frequenz.channels.base_classes.T">T</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The next value received.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#StopAsyncIteration">StopAsyncIteration</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>if the underlying channel is closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="fm">__anext__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Await the next value in the async iteration over received values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next value received.</span>

<span class="sd">    Raises:</span>
<span class="sd">        StopAsyncIteration: if the underlying channel is closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">ready</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">ChannelClosedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">StopAsyncIteration</span><span class="p">()</span> <span class="kn">from</span> <span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Receiver.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#frequenz.channels.base_classes.Receiver.consume" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value once <code>ready()</code> is complete.</p>
<p><code>ready()</code> must be called before each call to <code>consume()</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="frequenz.channels.base_classes.T">T</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The next value received.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.ChannelClosedError" href="base_classes/#frequenz.channels.base_classes.ChannelClosedError">ChannelClosedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>if the underlying channel is closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest value once `ready()` is complete.</span>

<span class="sd">    `ready()` must be called before each call to `consume()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next value received.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ChannelClosedError: if the underlying channel is closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Receiver.into_peekable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">into_peekable</span><span class="p">()</span></code>

<a href="#frequenz.channels.base_classes.Receiver.into_peekable" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Convert the <code>Receiver</code> implementation into a <code>Peekable</code>.</p>
<p>Once this function has been called, the receiver will no longer be
usable, and calling <code>receive</code> on the receiver will raise an exception.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError">NotImplementedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>when a <code>Receiver</code> implementation doesn't have
a custom <code>get_peekable</code> implementation.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">into_peekable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Peekable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert the `Receiver` implementation into a `Peekable`.</span>

<span class="sd">    Once this function has been called, the receiver will no longer be</span>
<span class="sd">    usable, and calling `receive` on the receiver will raise an exception.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: when a `Receiver` implementation doesn&#39;t have</span>
<span class="sd">            a custom `get_peekable` implementation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This receiver does not implement `into_peekable`&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Receiver.map" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">map</span><span class="p">(</span><span class="n">call</span><span class="p">)</span></code>

<a href="#frequenz.channels.base_classes.Receiver.map" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a receiver with <code>call</code> applied on incoming messages.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>call</code></td>
          <td class="doc-param-details">
            <p>function to apply on incoming messages.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="frequenz.channels.base_classes.T">T</span>], <span title="frequenz.channels.base_classes.U">U</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<span title="frequenz.channels.base_classes.U">U</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A <code>Receiver</code> to read results of the given function from.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">U</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return a receiver with `call` applied on incoming messages.</span>

<span class="sd">    Args:</span>
<span class="sd">        call: function to apply on incoming messages.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `Receiver` to read results of the given function from.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_Map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Receiver.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.base_classes.Receiver.ready" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until the receiver is ready with a value.</p>
<p>Once a call to <code>ready()</code> has finished, the value should be read with a call to
<code>consume()</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.ChannelClosedError" href="base_classes/#frequenz.channels.base_classes.ChannelClosedError">ChannelClosedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>if the underlying channel is closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value.</span>

<span class="sd">    Once a call to `ready()` has finished, the value should be read with a call to</span>
<span class="sd">    `consume()`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ChannelClosedError: if the underlying channel is closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Receiver.receive" class="doc doc-heading">
<code class="highlight language-python"><span class="n">receive</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.base_classes.Receiver.receive" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Receive a message from the channel.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.ChannelClosedError" href="base_classes/#frequenz.channels.base_classes.ChannelClosedError">ChannelClosedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>if the underlying channel is closed.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="frequenz.channels.base_classes.T">T</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The received message.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Receive a message from the channel.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ChannelClosedError: if the underlying channel is closed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The received message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">received</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">()</span>  <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
    <span class="k">except</span> <span class="ne">StopAsyncIteration</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span> <span class="kn">from</span> <span class="nn">exc</span>
    <span class="k">return</span> <span class="n">received</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Select" class="doc doc-heading">
        <code>frequenz.channels.Select</code>


<a href="#frequenz.channels.Select" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">

  
      <p>Select the next available message from a group of Receivers.</p>
<p>If <code>Select</code> was created with more <code>Receiver</code> than what are read in
the if-chain after each call to <a class="autorefs autorefs-internal" href="select/#frequenz.channels.select.Select.ready">ready()</a>,
messages coming in the additional receivers are dropped, and
a warning message is logged.</p>
<p><a class="autorefs autorefs-internal" href="#frequenz.channels.Receiver">Receiver</a>s also function as <code>Receiver</code>.</p>

<details class="example">
  <summary>Example</summary>
  <p>For example, if there are two receivers that you want to
simultaneously wait on, this can be done with:</p>
<div class="highlight"><pre><span></span><code><span class="n">select</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">name1</span> <span class="o">=</span> <span class="n">receiver1</span><span class="p">,</span> <span class="n">name2</span> <span class="o">=</span> <span class="n">receiver2</span><span class="p">)</span>
<span class="k">while</span> <span class="k">await</span> <span class="n">select</span><span class="o">.</span><span class="n">ready</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">msg</span> <span class="o">:=</span> <span class="n">select</span><span class="o">.</span><span class="n">name1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">:=</span> <span class="n">msg</span><span class="o">.</span><span class="n">inner</span><span class="p">:</span>
            <span class="c1"># do something with `val`</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># handle closure of receiver.</span>
            <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">msg</span> <span class="o">:=</span> <span class="n">select</span><span class="o">.</span><span class="n">name2</span><span class="p">:</span>
        <span class="c1"># do something with `msg.inner`</span>
        <span class="k">pass</span>
</code></pre></div>
</details>

        <details class="quote">
          <summary>Source code in <code>frequenz/channels/select.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Select</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Select the next available message from a group of Receivers.</span>

<span class="sd">    If `Select` was created with more `Receiver` than what are read in</span>
<span class="sd">    the if-chain after each call to [ready()][frequenz.channels.Select.ready],</span>
<span class="sd">    messages coming in the additional receivers are dropped, and</span>
<span class="sd">    a warning message is logged.</span>

<span class="sd">    [Receiver][frequenz.channels.Receiver]s also function as `Receiver`.</span>

<span class="sd">    Example:</span>
<span class="sd">        For example, if there are two receivers that you want to</span>
<span class="sd">        simultaneously wait on, this can be done with:</span>

<span class="sd">        ```python</span>
<span class="sd">        select = Select(name1 = receiver1, name2 = receiver2)</span>
<span class="sd">        while await select.ready():</span>
<span class="sd">            if msg := select.name1:</span>
<span class="sd">                if val := msg.inner:</span>
<span class="sd">                    # do something with `val`</span>
<span class="sd">                    pass</span>
<span class="sd">                else:</span>
<span class="sd">                    # handle closure of receiver.</span>
<span class="sd">                    pass</span>
<span class="sd">            elif msg := select.name2:</span>
<span class="sd">                # do something with `msg.inner`</span>
<span class="sd">                pass</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a `Select` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: sequence of receivers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ready</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_ReadyReceiver</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Wait until there is a message in any of the receivers.</span>

<span class="sd">        Returns `True` if there is a message available, and `False` if all</span>
<span class="sd">        receivers have closed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether there are further messages or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span><span class="p">:</span>
                <span class="n">dropped_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">dropped_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">recv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">value</span><span class="o">.</span><span class="n">recv</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Select.ready() dropped data from receiver(s): </span><span class="si">%s</span><span class="s2">, &quot;</span>
                    <span class="s2">&quot;because no messages have been fetched since the last call to ready().&quot;</span><span class="p">,</span>
                    <span class="n">dropped_names</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># once all the pending messages have been consumed, reset the</span>
        <span class="c1"># `_prev_ready_count` as well, and wait for new messages.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
            <span class="n">recv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="n">ChannelClosedError</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">recv</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ReadyReceiver</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="c1"># if channel or Receiver is closed</span>
            <span class="c1"># don&#39;t add a task for it again.</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ready</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest unread message from a `Receiver`, if available.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the channel.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Latest unread message for the specified `Receiver`, or `None`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: when the name was not specified when creating the</span>
<span class="sd">                `Select` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Select-functions">Functions<a href="#frequenz.channels.Select-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.select.Select.__del__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

<a href="#frequenz.channels.select.Select.__del__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Cleanup any pending tasks.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.select.Select.__getattr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#frequenz.channels.select.Select.__getattr__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest unread message from a <code>Receiver</code>, if available.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <p>Name of the channel.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Latest unread message for the specified <code>Receiver</code>, or <code>None</code>.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#KeyError">KeyError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>when the name was not specified when creating the
<code>Select</code> instance.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest unread message from a `Receiver`, if available.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Name of the channel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Latest unread message for the specified `Receiver`, or `None`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: when the name was not specified when creating the</span>
<span class="sd">            `Select` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.select.Select.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#frequenz.channels.select.Select.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>Select</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <p>sequence of receivers</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a `Select` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: sequence of receivers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ready</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_ReadyReceiver</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.select.Select.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.select.Select.ready" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until there is a message in any of the receivers.</p>
<p>Returns <code>True</code> if there is a message available, and <code>False</code> if all
receivers have closed.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Whether there are further messages or not.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Wait until there is a message in any of the receivers.</span>

<span class="sd">    Returns `True` if there is a message available, and `False` if all</span>
<span class="sd">    receivers have closed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether there are further messages or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span><span class="p">:</span>
            <span class="n">dropped_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">dropped_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">recv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">value</span><span class="o">.</span><span class="n">recv</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Select.ready() dropped data from receiver(s): </span><span class="si">%s</span><span class="s2">, &quot;</span>
                <span class="s2">&quot;because no messages have been fetched since the last call to ready().&quot;</span><span class="p">,</span>
                <span class="n">dropped_names</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># once all the pending messages have been consumed, reset the</span>
    <span class="c1"># `_prev_ready_count` as well, and wait for new messages.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_prev_ready_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="n">recv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="n">ChannelClosedError</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">recv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ready_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ReadyReceiver</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="c1"># if channel or Receiver is closed</span>
        <span class="c1"># don&#39;t add a task for it again.</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ready</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Sender" class="doc doc-heading">
        <code>frequenz.channels.Sender</code>


<a href="#frequenz.channels.Sender" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code>, <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.base_classes.T">T</span>]</code></p>

  
      <p>A channel Sender.</p>


        <details class="quote">
          <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Sender</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A channel Sender.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Send a message to the channel.</span>

<span class="sd">        Args:</span>
<span class="sd">            msg: The message to be sent.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the message was sent, based on whether the channel is open</span>
<span class="sd">                or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Sender-functions">Functions<a href="#frequenz.channels.Sender-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.base_classes.Sender.send" class="doc doc-heading">
<code class="highlight language-python"><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.base_classes.Sender.send" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Send a message to the channel.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td class="doc-param-details">
            <p>The message to be sent.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="frequenz.channels.base_classes.T">T</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Whether the message was sent, based on whether the channel is open
or not.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/base_classes.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Send a message to the channel.</span>

<span class="sd">    Args:</span>
<span class="sd">        msg: The message to be sent.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the message was sent, based on whether the channel is open</span>
<span class="sd">            or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.Timer" class="doc doc-heading">
        <code>frequenz.channels.Timer</code>


<a href="#frequenz.channels.Timer" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.Receiver" href="base_classes/#frequenz.channels.base_classes.Receiver">Receiver</a>[<a class="autorefs autorefs-external" title="datetime.datetime" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a>]</code></p>

  
      <p>A timer receiver that returns the timestamp every <code>interval</code> seconds.</p>
<p>Primarily for use with <a class="autorefs autorefs-internal" href="#frequenz.channels.Select">Select</a>.</p>
<p>The timestamp generated is a timezone-aware datetime using UTC as timezone.</p>

<details class="example">
  <summary>Example</summary>
  <p>When you want something to happen with a fixed period:</p>
<div class="highlight"><pre><span></span><code><span class="n">timer</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
<span class="n">select</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">bat_1</span> <span class="o">=</span> <span class="n">receiver1</span><span class="p">,</span> <span class="n">timer</span> <span class="o">=</span> <span class="n">timer</span><span class="p">)</span>
<span class="k">while</span> <span class="k">await</span> <span class="n">select</span><span class="o">.</span><span class="n">ready</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">msg</span> <span class="o">:=</span> <span class="n">select</span><span class="o">.</span><span class="n">bat_1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">:=</span> <span class="n">msg</span><span class="o">.</span><span class="n">inner</span><span class="p">:</span>
            <span class="n">process_data</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;battery channel closed&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ts</span> <span class="o">:=</span> <span class="n">select</span><span class="o">.</span><span class="n">timer</span><span class="p">:</span>
        <span class="c1"># something to do once every 30 seconds</span>
        <span class="k">pass</span>
</code></pre></div>
<p>When you want something to happen when nothing else has happened in a
certain interval:</p>
<div class="highlight"><pre><span></span><code><span class="n">timer</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
<span class="n">select</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">bat_1</span> <span class="o">=</span> <span class="n">receiver1</span><span class="p">,</span> <span class="n">timer</span> <span class="o">=</span> <span class="n">timer</span><span class="p">)</span>
<span class="k">while</span> <span class="k">await</span> <span class="n">select</span><span class="o">.</span><span class="n">ready</span><span class="p">():</span>
    <span class="n">timer</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">msg</span> <span class="o">:=</span> <span class="n">select</span><span class="o">.</span><span class="n">bat_1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">:=</span> <span class="n">msg</span><span class="o">.</span><span class="n">inner</span><span class="p">:</span>
            <span class="n">process_data</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;battery channel closed&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ts</span> <span class="o">:=</span> <span class="n">select</span><span class="o">.</span><span class="n">timer</span><span class="p">:</span>
        <span class="c1"># something to do if there&#39;s no battery data for 30 seconds</span>
        <span class="k">pass</span>
</code></pre></div>
</details>

        <details class="quote">
          <summary>Source code in <code>frequenz/channels/utils/timer.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Timer</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">datetime</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A timer receiver that returns the timestamp every `interval` seconds.</span>

<span class="sd">    Primarily for use with [Select][frequenz.channels.Select].</span>

<span class="sd">    The timestamp generated is a timezone-aware datetime using UTC as timezone.</span>

<span class="sd">    Example:</span>
<span class="sd">        When you want something to happen with a fixed period:</span>

<span class="sd">        ```python</span>
<span class="sd">        timer = channel.Timer(30.0)</span>
<span class="sd">        select = Select(bat_1 = receiver1, timer = timer)</span>
<span class="sd">        while await select.ready():</span>
<span class="sd">            if msg := select.bat_1:</span>
<span class="sd">                if val := msg.inner:</span>
<span class="sd">                    process_data(val)</span>
<span class="sd">                else:</span>
<span class="sd">                    logging.warn(&quot;battery channel closed&quot;)</span>
<span class="sd">            if ts := select.timer:</span>
<span class="sd">                # something to do once every 30 seconds</span>
<span class="sd">                pass</span>
<span class="sd">        ```</span>

<span class="sd">        When you want something to happen when nothing else has happened in a</span>
<span class="sd">        certain interval:</span>

<span class="sd">        ```python</span>
<span class="sd">        timer = channel.Timer(30.0)</span>
<span class="sd">        select = Select(bat_1 = receiver1, timer = timer)</span>
<span class="sd">        while await select.ready():</span>
<span class="sd">            timer.reset()</span>
<span class="sd">            if msg := select.bat_1:</span>
<span class="sd">                if val := msg.inner:</span>
<span class="sd">                    process_data(val)</span>
<span class="sd">                else:</span>
<span class="sd">                    logging.warn(&quot;battery channel closed&quot;)</span>
<span class="sd">            if ts := select.timer:</span>
<span class="sd">                # something to do if there&#39;s no battery data for 30 seconds</span>
<span class="sd">                pass</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a `Timer` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            interval: number of seconds between messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reset the timer to start timing from `now`.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Stop the timer.</span>

<span class="sd">        Once `stop` has been called, all subsequent calls to</span>
<span class="sd">        [receive()][frequenz.channels.Timer.receive] will immediately return</span>
<span class="sd">        `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the current time (in UTC) once the next tick is due.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ChannelClosedError: if [stop()][frequenz.channels.Timer.stop] has been</span>
<span class="sd">                called on the timer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The time of the next tick in UTC or `None` if</span>
<span class="sd">                [stop()][frequenz.channels.Timer.stop] has been called on the</span>
<span class="sd">                timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">-</span> <span class="n">now</span>
        <span class="k">while</span> <span class="n">diff</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
            <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">-</span> <span class="n">now</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="o">=</span> <span class="n">now</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            EOFError: When called before a call to `ready()` finishes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The timestamp for the next tick.</span>

<span class="sd">        Changelog:</span>
<span class="sd">            * **v0.11.0:** Returns a timezone-aware datetime with UTC timezone</span>
<span class="sd">              instead of a native datetime object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">),</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>
        <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">now</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.Timer-functions">Functions<a href="#frequenz.channels.Timer-functions" class="headerlink" title="Permanent link">¤</a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.timer.Timer.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span></code>

<a href="#frequenz.channels.utils.timer.Timer.__init__" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>Timer</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>interval</code></td>
          <td class="doc-param-details">
            <p>number of seconds between messages.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a `Timer` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        interval: number of seconds between messages.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.timer.Timer.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.utils.timer.Timer.consume" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value once <code>ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#EOFError">EOFError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>When called before a call to <code>ready()</code> finishes.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="datetime.datetime" href="https://docs.python.org/3/library/datetime.html#datetime.datetime">datetime</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The timestamp for the next tick.</p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="changelog">
  <summary>Changelog</summary>
  <ul>
<li><strong>v0.11.0:</strong> Returns a timezone-aware datetime with UTC timezone
  instead of a native datetime object.</li>
</ul>
</details>
      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        EOFError: When called before a call to `ready()` finishes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The timestamp for the next tick.</span>

<span class="sd">    Changelog:</span>
<span class="sd">        * **v0.11.0:** Returns a timezone-aware datetime with UTC timezone</span>
<span class="sd">          instead of a native datetime object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">),</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>
    <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">now</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.timer.Timer.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.utils.timer.Timer.ready" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the current time (in UTC) once the next tick is due.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.base_classes.ChannelClosedError" href="base_classes/#frequenz.channels.base_classes.ChannelClosedError">ChannelClosedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>if <a class="autorefs autorefs-internal" href="utils/timer/#frequenz.channels.utils.timer.Timer.stop">stop()</a> has been
called on the timer.</p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>None</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The time of the next tick in UTC or <code>None</code> if
<a class="autorefs autorefs-internal" href="utils/timer/#frequenz.channels.utils.timer.Timer.stop">stop()</a> has been called on the
timer.</p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the current time (in UTC) once the next tick is due.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ChannelClosedError: if [stop()][frequenz.channels.Timer.stop] has been</span>
<span class="sd">            called on the timer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The time of the next tick in UTC or `None` if</span>
<span class="sd">            [stop()][frequenz.channels.Timer.stop] has been called on the</span>
<span class="sd">            timer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ChannelClosedError</span><span class="p">()</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">-</span> <span class="n">now</span>
    <span class="k">while</span> <span class="n">diff</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">-</span> <span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="o">=</span> <span class="n">now</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.timer.Timer.reset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

<a href="#frequenz.channels.utils.timer.Timer.reset" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Reset the timer to start timing from <code>now</code>.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Reset the timer to start timing from `now`.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_next_msg_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.utils.timer.Timer.stop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>

<a href="#frequenz.channels.utils.timer.Timer.stop" class="headerlink" title="Permanent link">¤</a></h6>


  <div class="doc doc-contents ">
  
      <p>Stop the timer.</p>
<p>Once <code>stop</code> has been called, all subsequent calls to
[receive()][frequenz.channels.Timer.receive] will immediately return
<code>None</code>.</p>

      <details class="quote">
        <summary>Source code in <code>frequenz/channels/utils/timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Stop the timer.</span>

<span class="sd">    Once `stop` has been called, all subsequent calls to</span>
<span class="sd">    [receive()][frequenz.channels.Timer.receive] will immediately return</span>
<span class="sd">    `None`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Home
            </div>
          </div>
        </a>
      
      
        
        <a href="anycast/" class="md-footer__link md-footer__link--next" aria-label="Next: anycast" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              anycast
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Frequenz Energy-as-a-Service GmbH
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/frequenz-floss" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/company/frequenz-com" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "navigation.tracking", "toc.follow"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>